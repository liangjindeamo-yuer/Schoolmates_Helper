<!--这个HTML，和app task_received 的all_task_received.html类似-->
<!DOCTYPE html>
<head> 
    <meta charset="utf-8">
    <title>{{ username }}的任务广场</title> 
</head>
<body>
<!--2020年4月30日 新增 swf 退出登录-->
{% if username %}
    Welcome,{{ username }}！<br>
    <a href={% url 'task_received:logout' %}>退出登录</a>
{% else %}
    Welcome,游客!<br>
    <a href={% url 'hunt:login' %}>登录</a>
    <a href={% url 'hunt:index' %}>注册</a>
{% endif %}
<h1>任务广场</h1>
<!--一登录进去就是任务广场，含有其他按钮:个人中心、我要发布任务之类，链接加到这里-->
<a href={% url 'task_received:all_task_received' %}><h2>我接受的任务</h2></a>
<a href="http://127.0.0.1:8000/task_released/un_acp"><h2>我发布的任务</h2></a>
<a href={% url 'hunt:up0' %}><h2>我要发布任务</h2></a>

<!--2020年4月30日 swf 新增 关键词查找任务-->
<form action="{% url 'tasks_square:findtasks' %}" method="post">
    {% csrf_token %}
    <label for="keywords">输入关键词</label>
    <input type="text" name="keywords" id="keywords">
    <input type="submit" value="查询"/><br>
</form>

<!--可以把这几个放在一个下拉列表“排序方式”-->
<a href={% url 'tasks_square:task_square_sort' type_id 'id' %}>默认排序</a><br>
<a href={% url 'tasks_square:task_square_sort' type_id 'task_reward' %}>按酬劳升序</a><br>
<a href={% url 'tasks_square:task_square_sort' type_id '-task_reward' %}>按酬劳降序</a><br>
<a href={% url 'tasks_square:task_square_sort' type_id 'ddltime' %}>按截止时间升序</a><br>
<a href={% url 'tasks_square:task_square_sort' type_id '-ddltime' %}>按截止时间降序</a><br>

<div id="menu" style="background-color:; width:120px;float:left;">
    <!--任务类别；选中某类后，要能看出来是选中了这个选项-->
    <b>任务类别</b>
    <a href={% url 'tasks_square:task_square' %}>
        <ol>全部</ol>
    </a><br>
    {% for tasktype in task_types %}
        <a href={% url 'tasks_square:task_square_sort' tasktype.pk 'id' %}>
            <ol>{{ tasktype.typename }}</ol>
        </a><br>
    {% endfor %}
</div>

<div id="content" style="background-color:#EEEEEE;height:600px;width:450px;float:left;">
    <b>任务列表</b><br>
    <small>{{ sort }} {{ ordername }}</small>
    <ol>
        {% if tasks %}
            {% for task in tasks %}
                <a href={% url 'tasks_square:task_detail' task.id %}>{{ task.task_name }}</a><br>
                任务简述：
                <!--查到css可以实现只显示两行，现在这种因为用了p，前后距离大，前端或许能改-->
                <span style="overflow: hidden;text-overflow: ellipsis;display: -webkit-box;-webkit-line-clamp: 2;-webkit-box-orient: vertical;">{{ task.task_sketch }}</span>
                截止时间：{{ task.ddltime }}<br>
                ¥{{ task.task_reward }}<br>
                <form action="{% url 'tasks_square:check_hunt' task.id %}" method="post">
                    {% csrf_token %}
                    <input type="submit" value="接受任务"/>
                </form>
            {% endfor %}
        {% else %}
            暂无任务！
        {% endif %}
    </ol>
    <!--2020年4月30日 swf 分页功能-->
    <div class="pagination">
    <span class="step-links">
        {% if tasks.has_previous %}
            <a href="?page={{ tasks.previous_page_number }}">上一页</a>
        {% endif %}

        <span class="current">
            Page {{ tasks.number }} of {{ tasks.paginator.num_pages }}.
        </span>

        {% if tasks.has_next %}
            <a href="?page={{ tasks.next_page_number }}">下一页</a>
        {% endif %}
    </span>
    </div>
</div>
</body>


